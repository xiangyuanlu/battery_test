(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-92560ffc"],{4198:function(e,t,s){"use strict";s.r(t),s("7f7f"),s("aef6"),s("96cf");var i,a,n=s("3b8d"),l={name:"upload-file-box",data:function(){return{loading:!1,file:null,progress:0,status:1,disabled:!1,timer:null}},methods:{handleUpload:(a=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.file){e.next=3;break}return this.$message({type:"warning",message:this.$t("pleaseSelectFile")}),e.abrupt("return");case 3:return this.loading=!0,(t=new FormData).append("upgrade",this.file),e.next=8,this.$store.dispatch("system/upload",t);case 8:e.sent?(this.loading=!1,this.disabled=!0,this.$message({type:"success",message:this.$t("upgradeSuccessful")}),this.handleSuccess()):(this.loading=!1,this.status=2,this.file=null,this.$refs.input.value="",this.$message({type:"error",message:this.$t("upgradeFailed")}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)}),fileChange:function(e){var t,s=e.target.files;if(s&&0<s.length){if(!(t=s[0]).name.endsWith(".tgz"))return this.$message({type:"error",message:this.$t("errorFileTypeTips")}),this.$refs.input.value="",void(this.file=null);if(20971520<t.size)return this.$message({type:"error",message:this.$t("fileGT20MBTips")}),this.$refs.input.value="",void(this.file=null);this.file=t}},handleSuccess:function(){this.$emit("confirm")},handleConfirm:(i=Object(n.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.timer&&(clearInterval(this.timer),this.timer=null),this.status=3,this.timer=setInterval((function(){t.progress+=Math.floor(10*Math.random()),100<t.progress&&(t.progress=99)}),1e3),e.next=5,this.$store.dispatch("system/upgrade");case 5:if(!e.sent){e.next=12;break}clearInterval(this.timer),this.timer=null,this.progress=100,setTimeout((function(){t.status=4}),1500),e.next=16;break;case 12:clearInterval(this.timer),this.timer=null,this.progress="",this.status=5;case 16:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),handleCancel:function(){this.$store.dispatch("system/cancel"),this.$emit("cancel")},handleClose:function(){this.$store.dispatch("system/cancel"),this.$emit("cancel")},beforeDestroy:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},handleOut:function(){this.$emit("cancel")}}},r=(s("d838"),s("2877")),c=Object(r.a)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"upload-file-box"},[s("div",{staticClass:"content"},[s("div",{staticClass:"label"},[e._v(e._s(e.$t("setFile")))]),s("div",{staticClass:"select-file"},[s("label",{staticClass:"select-file-box",attrs:{for:"systemFileInput",title:e.file?e.file.name:e.$t("noFileSelected")}},[s("span",{staticClass:"select-file-label"},[e._v(e._s(e.$t("selectFile")))]),s("input",{ref:"input",attrs:{id:"systemFileInput",type:"file",disabled:e.disabled,accept:".tgz"},on:{change:e.fileChange}}),s("label",{staticClass:"select-file-empty",class:{"seelct-file-name":e.file},attrs:{for:"systemFileInput"}},[e._v(e._s(e.file?e.file.name:e.$t("noFileSelected")))])]),s("div",{staticStyle:{color:"red","margin-top":"12px"}},[e._v("\n        "+e._s(e.$t("onlyTgzAnd20M"))+"\n      ")])])]),s("div",{staticClass:"btn"},[1===e.status||2===e.status?s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleUpload}},[e._v(e._s(e.$t("upgrade")))]):e._e(),1===e.status?s("el-button",{attrs:{size:"small",type:"default"},on:{click:e.handleCancel}},[e._v(e._s(e.$t("cancel")))]):e._e(),2===e.status?s("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.handleOut}},[e._v(e._s(e.$t("exit")))]):e._e()],1)])}),[],!1,null,null,null);t.default=c.exports},"8f88":function(e,t,s){},d838:function(e,t,s){"use strict";var i=s("8f88");s.n(i).a}}]);